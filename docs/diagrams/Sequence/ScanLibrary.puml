@startuml

autonumber

actor User
participant "Web Interface" as Web
participant "Authentication Service" as Auth
participant "Backend Service" as Backend
participant "File System" as FileSys
database "Database" as DB

User -> Web: Send "Scan Library" signal
Web -> Auth: Authenticate User
Auth --> Web: Authentication Successful
Web -> Backend: Send "Scan Library" signal
Backend -> DB: Fetch Library paths from database
DB --> Backend: Return Library paths
Backend -> FileSys: Scan Library directories
FileSys --> Backend: Return scanned file paths
Backend -> DB: Update database with new/removed Content
DB --> Backend: Database updated successfully
group RefreshMetadata for new Content
    Backend -> Backend: Parse new file paths
    Backend -> "External Metadata Service \n (MangaUpdates/Comic Metadata)" as ExtMeta: Search for corresponding metadata
    ExtMeta --> Backend: Return matching metadata (if found)
    Backend -> DB: Update Content metadata in database
    DB --> Backend: Metadata updated successfully
end
Backend --> Web: Library scan completed
Web -> User: Confirm library scan completion

@enduml